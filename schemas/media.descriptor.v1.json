{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Media Descriptor v1",
  "type": "object",
  "required": ["id", "ts", "kind", "scope", "actor"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Media ID (UUID)"
    },
    "ts": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp"
    },
    "kind": {
      "type": "string",
      "enum": ["media.uploaded", "media.committed", "media.expired"],
      "description": "Event kind"
    },
    "scope": {
      "type": "object",
      "required": ["tenant"],
      "properties": {
        "tenant": { "type": "string" },
        "room": { "type": "string" },
        "entity": { "type": "string" }
      }
    },
    "actor": {
      "type": "object",
      "required": ["email"],
      "properties": {
        "email": { "type": "string" },
        "groups": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "refs": {
      "type": "object",
      "description": "References (media_id, thumb_media_id, etc.)"
    },
    "data": {
      "type": "object",
      "properties": {
        "mime": { "type": "string" },
        "bytes": { "type": "integer" },
        "sha256": { "type": "string" },
        "r2_key": { "type": "string" },
        "retention_policy": {
          "type": "string",
          "enum": ["ephemeral", "standard", "archival"]
        }
      }
    },
    "meta": {
      "type": "object",
      "properties": {
        "service": { "type": "string" }
      }
    },
    "sig": {
      "type": ["string", "null"],
      "description": "Ed25519 signature (optional)"
    }
  }
}
